<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ELANORA - Conflict Resolution</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1 class="logo">ELANORA</h1>
            <nav class="nav">
                <a href="projects.html" class="nav-link">Projects</a>
                <a href="index.html" class="nav-link">Dashboard</a>
                <a href="conflicts.html" class="nav-link active">Conflicts <span class="badge">7</span></a>
                <a href="tiers.html" class="nav-link">Tier Management</a>
                <a href="export.html" class="nav-link">Export</a>
                <div class="user-menu">
                    <span>Dr. Martin</span>
                    <button class="btn-logout" onclick="logout()">Logout</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Page Header -->
            <section class="page-header">
                <div class="header-info">
                    <h2>Conflict Resolution</h2>
                    <p>Project: LSFB Discourse Analysis</p>
                </div>
                <div class="header-stats">
                    <div class="stat-badge critical">
                        <span class="number">3</span>
                        <span class="label">Critical</span>
                    </div>
                    <div class="stat-badge warning">
                        <span class="number">4</span>
                        <span class="label">Medium</span>
                    </div>
                    <div class="stat-badge resolved">
                        <span class="number">12</span>
                        <span class="label">Resolved</span>
                    </div>
                </div>
            </section>

            <!-- Conflict Filters -->
            <section class="conflict-filters">
                <div class="filter-group">
                    <select class="filter-select">
                        <option>All Files</option>
                        <option>session_001_discourse.eaf</option>
                        <option>session_002_fluence.eaf</option>
                        <option>session_003_prosody.eaf</option>
                    </select>
                    <select class="filter-select">
                        <option>All Priorities</option>
                        <option>üî¥ Critical</option>
                        <option>üü° Medium</option>
                        <option>üü¢ Low</option>
                    </select>
                    <select class="filter-select">
                        <option>All Contributors</option>
                        <option>Dr. Martin</option>
                        <option>Prof. Laurent</option>
                        <option>Dr. Smith</option>
                    </select>
                </div>
                <div class="view-options">
                    <button class="view-btn active" data-view="list">List View</button>
                    <button class="view-btn" data-view="timeline">Timeline View</button>
                </div>
            </section>

            <!-- Conflicts List -->
            <section class="conflicts-container">
                <!-- Critical Conflict -->
                <div class="conflict-card critical" data-id="conflict-1">
                    <div class="conflict-header">
                        <div class="conflict-title">
                            <span class="priority-indicator critical">üî¥</span>
                            <h3>Fluency_Main Annotation Conflict</h3>
                            <span class="conflict-badge">Critical</span>
                        </div>
                        <div class="conflict-meta">
                            <span>üìÅ session_001_discourse.eaf</span>
                            <span>‚è±Ô∏è 0:25-0:30</span>
                            <span>üë• 2 contributors</span>
                        </div>
                    </div>
                    
                    <div class="conflict-body">
                        <div class="conflict-description">
                            <p>Conflicting annotations for hesitation markers between Dr. Martin and Prof. Laurent</p>
                        </div>
                        
                        <div class="conflict-versions">
                            <div class="version-container">
                                <div class="version version-a">
                                    <div class="version-header">
                                        <div class="contributor-info">
                                            <div class="avatar">Dr. M</div>
                                            <div>
                                                <strong>Dr. Martin</strong>
                                                <small>Today 14:30</small>
                                            </div>
                                        </div>
                                        <div class="version-actions">
                                            <button class="btn-xs" onclick="selectVersion('conflict-1', 'martin')">Select</button>
                                        </div>
                                    </div>
                                    <div class="version-content">
                                        <code class="annotation-code">
                                            FLUENCE_MAIN: "pause longue, h√©sitation"
                                        </code>
                                        <div class="version-details">
                                            <p><strong>Context:</strong> Clear hesitation with noticeable pause</p>
                                            <p><strong>Duration:</strong> 5.2 seconds</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="version version-b">
                                    <div class="version-header">
                                        <div class="contributor-info">
                                            <div class="avatar">Pr. L</div>
                                            <div>
                                                <strong>Prof. Laurent</strong>
                                                <small>Today 15:45</small>
                                            </div>
                                        </div>
                                        <div class="version-actions">
                                            <button class="btn-xs" onclick="selectVersion('conflict-1', 'laurent')">Select</button>
                                        </div>
                                    </div>
                                    <div class="version-content">
                                        <code class="annotation-code">
                                            FLUENCE_MAIN: "pause_longue, h√©sitation_marqu√©e"
                                        </code>
                                        <div class="version-details">
                                            <p><strong>Context:</strong> Pronounced hesitation with standardized notation</p>
                                            <p><strong>Duration:</strong> 5.2 seconds</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="conflict-actions">
                            <div class="auto-suggestions">
                                <h4>AI Suggestions</h4>
                                <div class="suggestion-options">
                                    <button class="suggestion-btn" onclick="applySuggestion('conflict-1', 'merge')">
                                        ü§ñ Merge: "pause_longue, h√©sitation_marqu√©e"
                                        <small>95% confidence</small>
                                    </button>
                                    <button class="suggestion-btn" onclick="applySuggestion('conflict-1', 'standardize')">
                                        üìè Apply standard: Use underscores
                                        <small>Follows project conventions</small>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="manual-actions">
                                <button class="btn-secondary" onclick="showMergeEditor('conflict-1')">
                                    ‚úèÔ∏è Manual Merge
                                </button>
                                <button class="btn-secondary" onclick="requestReview('conflict-1')">
                                    üë• Request Review
                                </button>
                                <button class="btn-primary" onclick="resolveConflict('conflict-1')">
                                    ‚úÖ Mark Resolved
                                </button>
                            </div>
                        </div>
                        
                        <div class="conflict-comments">
                            <h4>Discussion</h4>
                            <div class="comment">
                                <div class="comment-author">Dr. Martin</div>
                                <div class="comment-content">
                                    I used the standard notation we agreed on last week. Should we stick to underscores?
                                </div>
                                <div class="comment-time">2 hours ago</div>
                            </div>
                            <div class="comment">
                                <div class="comment-author">Prof. Laurent</div>
                                <div class="comment-content">
                                    Yes, let's use underscores for consistency. Also added "marqu√©e" to indicate intensity.
                                </div>
                                <div class="comment-time">1 hour ago</div>
                            </div>
                            <div class="add-comment">
                                <input type="text" placeholder="Add a comment..." class="comment-input">
                                <button class="btn-xs">Comment</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Medium Priority Conflict -->
                <div class="conflict-card medium" data-id="conflict-2">
                    <div class="conflict-header">
                        <div class="conflict-title">
                            <span class="priority-indicator medium">üü°</span>
                            <h3>Prosody_Stress Timing Overlap</h3>
                            <span class="conflict-badge medium">Medium</span>
                        </div>
                        <div class="conflict-meta">
                            <span>üìÅ session_002_fluence.eaf</span>
                            <span>‚è±Ô∏è 1:15-1:22</span>
                            <span>üë• 2 contributors</span>
                        </div>
                    </div>
                    
                    <div class="conflict-body collapsed">
                        <div class="conflict-description">
                            <p>Overlapping time boundaries for stress annotations</p>
                        </div>
                        
                        <div class="conflict-preview">
                            <span class="preview-text">Dr. Smith: "stress_primary [1:15.2-1:18.7]" vs Dr. Martin: "stress_primary [1:14.8-1:19.1]"</span>
                            <button class="btn-xs expand-btn" onclick="expandConflict('conflict-2')">Expand</button>
                        </div>
                    </div>
                </div>

                <!-- Low Priority Conflict -->
                <div class="conflict-card low" data-id="conflict-3">
                    <div class="conflict-header">
                        <div class="conflict-title">
                            <span class="priority-indicator low">üü¢</span>
                            <h3>Discourse_Markers Terminology</h3>
                            <span class="conflict-badge low">Low</span>
                        </div>
                        <div class="conflict-meta">
                            <span>üìÅ session_003_prosody.eaf</span>
                            <span>‚è±Ô∏è 2:30-2:35</span>
                            <span>üë• 2 contributors</span>
                        </div>
                    </div>
                    
                    <div class="conflict-body collapsed">
                        <div class="conflict-description">
                            <p>Different terminology used for discourse markers</p>
                        </div>
                        
                        <div class="conflict-preview">
                            <span class="preview-text">Prof. Laurent: "connector" vs Dr. Smith: "discourse_marker"</span>
                            <button class="btn-xs expand-btn" onclick="expandConflict('conflict-3')">Expand</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Resolution Summary -->
            <section class="resolution-summary">
                <h3>Resolution Progress</h3>
                <div class="progress-overview">
                    <div class="progress-bar-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 63%;"></div>
                        </div>
                        <span class="progress-text">12 of 19 conflicts resolved (63%)</span>
                    </div>
                    <div class="resolution-stats">
                        <div class="stat">
                            <strong>7</strong> Active conflicts
                        </div>
                        <div class="stat">
                            <strong>3</strong> Need attention
                        </div>
                        <div class="stat">
                            <strong>2</strong> Under review
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Manual Merge Modal -->
    <div id="mergeModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Manual Merge Editor</h3>
                <button class="close" onclick="closeModal('mergeModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="merge-editor">
                    <div class="merge-sections">
                        <div class="merge-section">
                            <h4>Original Versions</h4>
                            <div class="original-versions">
                                <div class="original-version">
                                    <strong>Dr. Martin:</strong>
                                    <code>"pause longue, h√©sitation"</code>
                                </div>
                                <div class="original-version">
                                    <strong>Prof. Laurent:</strong>
                                    <code>"pause_longue, h√©sitation_marqu√©e"</code>
                                </div>
                            </div>
                        </div>
                        
                        <div class="merge-section">
                            <h4>Merged Version</h4>
                            <textarea class="merge-textarea" rows="3" placeholder="Enter your merged annotation...">pause_longue, h√©sitation_marqu√©e</textarea>
                        </div>
                    </div>
                    
                    <div class="merge-metadata">
                        <div class="form-group">
                            <label>Resolution Notes</label>
                            <textarea rows="2" placeholder="Explain your resolution decision...">Applied project standard for underscore notation and included intensity marker as suggested by Prof. Laurent</textarea>
                        </div>
                        <div class="form-group">
                            <label>Notify Contributors</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" checked> Dr. Martin</label>
                                <label><input type="checkbox" checked> Prof. Laurent</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('mergeModal')">Cancel</button>
                <button class="btn-primary">Apply Merge</button>
            </div>
        </div>
    </div>

    <script src="auth.js"></script>
    <script src="script.js"></script>
    <script>
        function selectVersion(conflictId, version) {
            console.log(`Selecting version ${version} for conflict ${conflictId}`);
            // Implementation for version selection
        }
        
        function applySuggestion(conflictId, suggestionType) {
            console.log(`Applying ${suggestionType} suggestion for conflict ${conflictId}`);
            // Implementation for applying AI suggestions
        }
        
        function showMergeEditor(conflictId) {
            showModal('mergeModal');
        }
        
        function requestReview(conflictId) {
            console.log(`Requesting review for conflict ${conflictId}`);
            // Implementation for requesting peer review
        }
        
        function resolveConflict(conflictId) {
            const conflictCard = document.querySelector(`[data-id="${conflictId}"]`);
            conflictCard.classList.add('resolved');
            console.log(`Marking conflict ${conflictId} as resolved`);
        }
        
        function expandConflict(conflictId) {
            const conflictCard = document.querySelector(`[data-id="${conflictId}"]`);
            const conflictBody = conflictCard.querySelector('.conflict-body');
            conflictBody.classList.toggle('collapsed');
            
            // Load full conflict details if expanded
            if (!conflictBody.classList.contains('collapsed')) {
                loadConflictDetails(conflictId);
            }
        }
        
        function loadConflictDetails(conflictId) {
            // Implementation to load full conflict details
            console.log(`Loading full details for conflict ${conflictId}`);
        }
        
        // View switching
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const view = this.dataset.view;
                    if (view === 'timeline') {
                        // Switch to timeline view
                        console.log('Switching to timeline view');
                    } else {
                        // Switch to list view
                        console.log('Switching to list view');
                    }
                });
            });
        });
    </script>
</body>
</html>
