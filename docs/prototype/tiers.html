<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ELANORA - Tier Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1 class="logo">ELANORA</h1>
            <nav class="nav">
                <a href="projects.html" class="nav-link">Projects</a>
                <a href="index.html" class="nav-link">Dashboard</a>
                <a href="conflicts.html" class="nav-link">Conflicts <span class="badge">3</span></a>
                <a href="tiers.html" class="nav-link active">Tier Management</a>
                <a href="export.html" class="nav-link">Export</a>
                <div class="user-menu">
                    <span>Dr. Martin</span>
                    <button class="btn-logout" onclick="logout()">Logout</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Page Header -->
            <section class="page-header">
                <div class="header-info">
                    <h2>Tier Management</h2>
                    <p>Project: LSFB Discourse Analysis</p>
                </div>
                <div class="header-controls">
                    <input type="search" placeholder="Search tiers..." class="search-input">
                    <select class="filter-select">
                        <option>All Groups</option>
                        <option>Fluency</option>
                        <option>Prosody</option>
                        <option>Discourse Markers</option>
                        <option>Constructed Actions</option>
                    </select>
                    <select class="filter-select">
                        <option>All Status</option>
                        <option>‚úÖ Validated</option>
                        <option>‚ö†Ô∏è Conflicts</option>
                        <option>üîÑ In Progress</option>
                        <option>üìù Draft</option>
                    </select>
                </div>
            </section>

            <div class="tier-layout">
                <!-- Tier Tree Sidebar -->
                <aside class="tier-sidebar">
                    <div class="tier-tree">
                        <div class="tree-header">
                            <h3>Tier Hierarchy</h3>
                            <button class="btn-sm" onclick="expandAll()">Expand All</button>
                        </div>
                        
                        <div class="tree-container">
                            <div class="tree-node expanded" data-group="fluency">
                                <div class="node-header" onclick="toggleNode(this)">
                                    <span class="expand-icon">‚ñº</span>
                                    <span class="node-icon">üí¨</span>
                                    <span class="node-title">Fluency</span>
                                    <span class="node-count">(24)</span>
                                    <span class="status-indicator conflict">‚ö†Ô∏è</span>
                                </div>
                                <div class="node-children">
                                    <div class="tree-node leaf" data-tier="fluency-main">
                                        <div class="node-header" onclick="selectTier('fluency-main')">
                                            <span class="node-icon">üìù</span>
                                            <span class="node-title">Fluency_Main</span>
                                            <span class="status-indicator conflict">‚ö†Ô∏è</span>
                                        </div>
                                    </div>
                                    <div class="tree-node leaf" data-tier="fluency-hesitation">
                                        <div class="node-header" onclick="selectTier('fluency-hesitation')">
                                            <span class="node-icon">üìù</span>
                                            <span class="node-title">Fluency_Hesitation</span>
                                            <span class="status-indicator ok">‚úÖ</span>
                                        </div>
                                    </div>
                                    <div class="tree-node leaf" data-tier="fluency-pauses">
                                        <div class="node-header" onclick="selectTier('fluency-pauses')">
                                            <span class="node-icon">üìù</span>
                                            <span class="node-title">Fluency_Pauses</span>
                                            <span class="status-indicator progress">üîÑ</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="tree-node expanded" data-group="prosody">
                                <div class="node-header" onclick="toggleNode(this)">
                                    <span class="expand-icon">‚ñº</span>
                                    <span class="node-icon">üéµ</span>
                                    <span class="node-title">Prosody</span>
                                    <span class="node-count">(18)</span>
                                    <span class="status-indicator ok">‚úÖ</span>
                                </div>
                                <div class="node-children">
                                    <div class="tree-node leaf" data-tier="prosody-stress">
                                        <div class="node-header" onclick="selectTier('prosody-stress')">
                                            <span class="node-icon">üìù</span>
                                            <span class="node-title">Prosody_Stress</span>
                                            <span class="status-indicator ok">‚úÖ</span>
                                        </div>
                                    </div>
                                    <div class="tree-node leaf" data-tier="prosody-rhythm">
                                        <div class="node-header" onclick="selectTier('prosody-rhythm')">
                                            <span class="node-icon">üìù</span>
                                            <span class="node-title">Prosody_Rhythm</span>
                                            <span class="status-indicator ok">‚úÖ</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="tree-node" data-group="discourse">
                                <div class="node-header" onclick="toggleNode(this)">
                                    <span class="expand-icon">‚ñ∂</span>
                                    <span class="node-icon">üí≠</span>
                                    <span class="node-title">Discourse Markers</span>
                                    <span class="node-count">(12)</span>
                                    <span class="status-indicator progress">üîÑ</span>
                                </div>
                                <div class="node-children" style="display: none;">
                                    <div class="tree-node leaf" data-tier="discourse-connectors">
                                        <div class="node-header" onclick="selectTier('discourse-connectors')">
                                            <span class="node-icon">üìù</span>
                                            <span class="node-title">Discourse_Connectors</span>
                                            <span class="status-indicator progress">üîÑ</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="tree-node" data-group="constructed">
                                <div class="node-header" onclick="toggleNode(this)">
                                    <span class="expand-icon">‚ñ∂</span>
                                    <span class="node-icon">üé≠</span>
                                    <span class="node-title">Constructed Actions</span>
                                    <span class="node-count">(8)</span>
                                    <span class="status-indicator draft">üìù</span>
                                </div>
                                <div class="node-children" style="display: none;">
                                    <!-- Children would be here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- Main Tier Content -->
                <main class="tier-content">
                    <div class="tier-detail" id="tierDetail">
                        <div class="tier-header">
                            <h3>Fluency_Main</h3>
                            <div class="tier-actions">
                                <button class="btn-sm">Export Tier</button>
                                <button class="btn-sm primary">Resolve Conflicts</button>
                            </div>
                        </div>

                        <div class="tier-info">
                            <div class="info-grid">
                                <div class="info-item">
                                    <label>Type:</label>
                                    <span>Fluency Annotation</span>
                                </div>
                                <div class="info-item">
                                    <label>Contributors:</label>
                                    <span>Dr. Martin, Prof. Laurent, Dr. Smith</span>
                                </div>
                                <div class="info-item">
                                    <label>Last Modified:</label>
                                    <span>2 hours ago</span>
                                </div>
                                <div class="info-item">
                                    <label>Total Annotations:</label>
                                    <span>47</span>
                                </div>
                                <div class="info-item">
                                    <label>Conflicts:</label>
                                    <span class="conflict-count">3 active conflicts</span>
                                </div>
                            </div>
                        </div>

                        <div class="tier-annotations">
                            <div class="annotations-header">
                                <h4>Annotations</h4>
                                <div class="view-controls">
                                    <button class="view-btn active" data-view="timeline">Timeline</button>
                                    <button class="view-btn" data-view="list">List</button>
                                    <button class="view-btn" data-view="conflicts">Conflicts Only</button>
                                </div>
                            </div>

                            <div class="timeline-view" id="timelineView">
                                <div class="timeline-header">
                                    <div class="time-markers">
                                        <span>0:00</span>
                                        <span>0:30</span>
                                        <span>1:00</span>
                                        <span>1:30</span>
                                        <span>2:00</span>
                                    </div>
                                </div>
                                
                                <div class="timeline-tracks">
                                    <div class="track" data-contributor="martin">
                                        <div class="track-label">Dr. Martin</div>
                                        <div class="track-content">
                                            <div class="annotation-block" data-time="0:05-0:12" style="left: 4%; width: 7%;">
                                                <span class="annotation-text">pause_longue</span>
                                            </div>
                                            <div class="annotation-block conflict" data-time="0:25-0:30" style="left: 20%; width: 5%;">
                                                <span class="annotation-text">h√©sitation</span>
                                            </div>
                                            <div class="annotation-block" data-time="0:45-0:52" style="left: 36%; width: 7%;">
                                                <span class="annotation-text">fluent</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="track" data-contributor="laurent">
                                        <div class="track-label">Prof. Laurent</div>
                                        <div class="track-content">
                                            <div class="annotation-block" data-time="0:05-0:12" style="left: 4%; width: 7%;">
                                                <span class="annotation-text">pause_longue</span>
                                            </div>
                                            <div class="annotation-block conflict" data-time="0:25-0:30" style="left: 20%; width: 5%;">
                                                <span class="annotation-text">h√©sitation_marqu√©e</span>
                                            </div>
                                            <div class="annotation-block" data-time="0:45-0:52" style="left: 36%; width: 7%;">
                                                <span class="annotation-text">fluent</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="conflicts-summary">
                                <h4>Active Conflicts</h4>
                                <div class="conflict-list">
                                    <div class="conflict-item" onclick="showConflictDetail('conflict-1')">
                                        <div class="conflict-info">
                                            <strong>0:25-0:30</strong>
                                            <span class="conflict-desc">"h√©sitation" vs "h√©sitation_marqu√©e"</span>
                                        </div>
                                        <div class="conflict-actions">
                                            <button class="btn-xs">Resolve</button>
                                        </div>
                                    </div>
                                    <div class="conflict-item" onclick="showConflictDetail('conflict-2')">
                                        <div class="conflict-info">
                                            <strong>1:15-1:22</strong>
                                            <span class="conflict-desc">"pause" vs "pause_longue"</span>
                                        </div>
                                        <div class="conflict-actions">
                                            <button class="btn-xs">Resolve</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </main>

    <script src="auth.js"></script>
    <script src="script.js"></script>
    <script>
        function toggleNode(nodeHeader) {
            const node = nodeHeader.parentElement;
            const children = node.querySelector('.node-children');
            const expandIcon = nodeHeader.querySelector('.expand-icon');
            
            if (children) {
                if (children.style.display === 'none') {
                    children.style.display = 'block';
                    expandIcon.textContent = '‚ñº';
                    node.classList.add('expanded');
                } else {
                    children.style.display = 'none';
                    expandIcon.textContent = '‚ñ∂';
                    node.classList.remove('expanded');
                }
            }
        }
        
        function selectTier(tierId) {
            // Remove previous selections
            document.querySelectorAll('.tree-node.selected').forEach(node => {
                node.classList.remove('selected');
            });
            
            // Add selection to clicked tier
            document.querySelector(`[data-tier="${tierId}"]`).classList.add('selected');
            
            // Update tier detail view
            updateTierDetail(tierId);
        }
        
        function updateTierDetail(tierId) {
            // This would update the main content area with tier-specific data
            console.log('Updating tier detail for:', tierId);
        }
        
        function expandAll() {
            document.querySelectorAll('.tree-node').forEach(node => {
                const children = node.querySelector('.node-children');
                const expandIcon = node.querySelector('.expand-icon');
                if (children) {
                    children.style.display = 'block';
                    expandIcon.textContent = '‚ñº';
                    node.classList.add('expanded');
                }
            });
        }
        
        function showConflictDetail(conflictId) {
            window.location.href = `conflicts.html#${conflictId}`;
        }
        
        // View switching
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const view = this.dataset.view;
                    // Switch view logic would go here
                    console.log('Switching to view:', view);
                });
            });
        });
    </script>
</body>
</html>
